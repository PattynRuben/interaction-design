<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&family=Source+Sans+Pro:ital,wght@0,200;0,300;0,400;0,600;0,700;0,900;1,200;1,300;1,400;1,600;1,700;1,900&display=swap"
        rel="stylesheet">

    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">


    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/screen.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.min.js"></script>
    <script src="script/datahandler.js"></script>
    <!--<script src="script/app.js"></script>-->
    <title>Trivia question generator</title>
</head>

<body>
    <svg aria-hidden="true" style="position: absolute; width: 0; height: 0; overflow: hidden;" version="1.1"
        xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
        <defs>
            <symbol id="icon-check" viewBox="0 0 32 32">
                <path d="M12.6 23.8l-7.467-7.467 1.433-1.433 6.033 6.033 12.8-12.8 1.433 1.433z"></path>
            </symbol>
            <symbol id="icon-close" viewBox="0 0 32 32">
                <path
                    d="M8.3 25.1l-1.4-1.4 7.7-7.7-7.7-7.7 1.4-1.4 7.7 7.7 7.7-7.7 1.4 1.4-7.7 7.7 7.7 7.7-1.4 1.4-7.7-7.7z">
                </path>
            </symbol>
            <symbol id="icon-expand" viewBox="0 0 32 32">
                <path d="M16 20.5l-8-8 1.433-1.433 6.567 6.6 6.567-6.567 1.433 1.433z"></path>
            </symbol>
            <symbol id="icon-refresh" viewBox="0 0 32 32">
                <path
                    d="M16 26.667q-4.433 0-7.55-3.117t-3.117-7.55 3.117-7.55 7.55-3.117q2.833 0 4.967 1.15t3.7 3.15v-4.3h2v8.467h-8.467v-2h5.6q-1.267-2-3.233-3.233t-4.567-1.233q-3.633 0-6.15 2.517t-2.517 6.15 2.517 6.15 6.15 2.517q2.767 0 5.067-1.583t3.2-4.183h2.067q-0.967 3.5-3.833 5.633t-6.5 2.133z">
                </path>
            </symbol>
            <symbol id="icon-reload" viewBox="0 0 32 32">
                <path
                    d="M16 26.667q-4.433 0-7.55-3.117t-3.117-7.55 3.117-7.55 7.55-3.117q2.833 0 4.967 1.15t3.7 3.15v-4.3h2v8.467h-8.467v-2h5.6q-1.267-2-3.233-3.233t-4.567-1.233q-3.633 0-6.15 2.517t-2.517 6.15 2.517 6.15 6.15 2.517q2.767 0 5.067-1.583t3.2-4.183h2.067q-0.967 3.5-3.833 5.633t-6.5 2.133z">
                </path>
            </symbol>
        </defs>
    </svg>
    <section class="o-row o-row--login">
        <div class="o-container">
            <h1 class="c-logo">
                <img class="c-logo__symbol" src="img/logo-no-background.png" alt="logo trivia question generator">
            </h1>
            <div class="c-flip-card">
                <div class="c-flip--inner">
                    <div class="c-card c-card--front">
                        <div class="c-card__header">
                            <h2 class="c-card__category">
                                Category: history
                            </h2>
                            <div class="c-component-range">
                                <Label class="c-label" for="range-id-front">Difficulty:</Label>
                                <input class="c-range js-range" type="range" id="range-id-front" min="1" max="10"
                                    value="5" disabled>
                            </div>
                        </div>
                        <div class="c-card__body">
                            <h2 class="c-card__title js-question">
                                Who was the first American in space?
                            </h2>
                            <div class="c-grid">
                                <div class="c-grid__option">
                                    <button id="a" class="o-button-reset c-button c-button--a js-answer js-answer-a js-disable">
                                        A. Neil Armstrong
                                    </button>
                                </div>
                                <div class="c-grid__option">
                                    <button id="b" class="o-button-reset c-button c-button--b js-answer js-answer-b js-disable">
                                        B. Buzz Aldrin
                                    </button>
                                </div>
                                <div class="c-grid__option">
                                    <button id="c" class="o-button-reset c-button c-button--c js-answer js-answer-c js-disable">
                                        C. Allan Sheppard
                                    </button>
                                </div>
                                <div class="c-grid__option">
                                    <button id="d" class="o-button-reset c-button c-button--d js-answer js-answer-d js-disable">
                                        C. Allan Sheppard
                                    </button>
                                </div>
                            </div>
                            <button class="o-button-reset c-button c-button--answer js-button js-button--answer js-disable">Show answer</button>
                        </div>

                    </div>
                    <div class="c-card c-card--answers">
                        <div class="c-card__header">
                            <h2 class="c-card__category">
                                Category: history
                            </h2>
                            <div class="c-component-range">
                                <Label class="c-label" for="range-id-answers">Difficulty:</Label>
                                <input class="c-range js-range" type="range" id="range-id-answers" min="1" max="10"
                                    value="5">
                            </div>
                        </div>
                        <div class="c-card__body">
                            <h2 class="c-card__title js-question">
                                Who was the first American in space?
                            </h2>
                            <h2 class="c-answer-feedbacktext c-answer-feedbacktext-false">
                                False!
                            </h2>
                            <p class="c-card__body--text">
                                Percentage of options selected:
                            </p>
                            <div class="c-percentages">
                                <div>
                                    <canvas id="chartProgressA" class="c-chart"></canvas>
                                </div>
                                <div>
                                    <canvas id="chartProgressB" class="c-chart"></canvas>
                                </div>
                                <div>
                                    <canvas id="chartProgressC" class="c-chart"></canvas>
                                </div>
                                <div>
                                    <canvas id="chartProgressD" class="c-chart"></canvas>
                                </div>

                            </div>
                            <div class="c-grid">
                                <div class="c-grid__answer c-answer-a-feedback js-answer-box-a">
                                    <p class="c-answer-text js-answer-a">A. Neil Armstrong</p>
                                    <svg class="c-answer-svg c-false-icon-a" xmlns="http://www.w3.org/2000/svg"
                                        height="48" width="48">
                                        <use xlink:href="#icon-close"></use>
                                    </svg>
                                    <svg class="c-answer-svg c-correct-icon-a" xmlns="http://www.w3.org/2000/svg"
                                        height="48" width="48">
                                        <use xlink:href="#icon-check"></use>
                                    </svg>
                                </div>
                                <div class="c-grid__answer c-answer-b-feedback js-answer-box-b">
                                    <p class="c-answer-text js-answer-b">B. Buzz Aldrin</p>
                                    <svg class="c-answer-svg c-false-icon-b" xmlns="http://www.w3.org/2000/svg"
                                        height="48" width="48">
                                        <use xlink:href="#icon-close"></use>
                                    </svg>
                                    <svg class="c-answer-svg c-correct-icon-b" xmlns="http://www.w3.org/2000/svg"
                                        height="48" width="48">
                                        <use xlink:href="#icon-check"></use>
                                    </svg>
                                </div>
                                <div class="c-grid__answer c-answer-c-feedback js-answer-box-c">
                                    <p class="c-answer-text js-answer-c">D. Michael Collins</p>
                                    <svg class="c-answer-svg c-false-icon-c" xmlns="http://www.w3.org/2000/svg"
                                        height="48" width="48">
                                        <use xlink:href="#icon-close"></use>
                                    </svg>
                                    <svg class="c-answer-svg c-correct-icon-c" xmlns="http://www.w3.org/2000/svg"
                                        height="48" width="48">
                                        <use xlink:href="#icon-check"></use>
                                    </svg>
                                </div>
                                <div class="c-grid__answer c-answer-d-feedback js-answer-box-d">
                                    <p class="c-answer-text js-answer-d">D. Michael Collins</p>
                                    <svg class="c-answer-svg c-false-icon-d" xmlns="http://www.w3.org/2000/svg"
                                        height="48" width="48">
                                        <use xlink:href="#icon-close"></use>
                                    </svg>
                                    <svg class="c-answer-svg c-correct-icon-d" xmlns="http://www.w3.org/2000/svg"
                                        height="48" width="48">
                                        <use xlink:href="#icon-check"></use>
                                    </svg>
                                </div>
                            </div>

                        </div>
                    </div>
                    <div class="c-card c-card--back">
                        <div class="c-card__header">
                            <h2 class="c-card__category">
                                Category: history
                            </h2>
                            <div class="c-component-range">
                                <Label class="c-label c-label--dark" for="range-id-back">Difficulty:</Label>
                                <input class="c-range js-range" type="range" id="range-id-back" min="1" max="10"
                                    value="5">
                            </div>
                        </div>
                        <div class="c-card__body">
                            <h2 class="c-card__title js-question">
                                Who was the first American in space?
                            </h2>
                            <h2 class="c-card__title js-answer-def">
                                Alan Sheppard
                            </h2>

                            <button class="o-button-reset c-button c-button--answer c-button--back js-button js-button--question js-disable">Show
                                question</button>

                        </div>
                    </div>
                </div>
            </div>

            <button class="o-button-reset c-logo--dark js-new-question u-max-width-sm">
                <svg class="c-logo__path--white" xmlns="http://www.w3.org/2000/svg" height="48" width="48">
                    <use xlink:href="#icon-reload"></use>
                </svg>
                <span class="c-span">Generate new question</span>
            </button>
        </div>

    </section>
    <script>
      'use strict';
let data, globalCorrectAnswer, globalStukData;
let percentageA, percentageB, percentageC, percentageD;
var myChartCircleA, myChartCircleB, myChartCircleC, myChartCircleD;
const listenToButtonAnswerQuestion = function () {
  document.querySelectorAll('.js-button').forEach((button) => {
    button.addEventListener('click', function (e) {
      document.querySelector('.c-flip--inner').classList.toggle('is-flipped');
      disableButtons();
    });
  });
};

const listenToReloadButton = function () {
  document.querySelectorAll('.js-new-question').forEach((button) => {
    button.addEventListener('click', function () {
      document.querySelector('.c-card--front').style.display = 'block';
      document.querySelector('.c-card--answers').style.display = 'none';
      if (document.querySelector('.c-flip--inner').classList.contains('is-flipped')) {
        document.querySelector('.c-flip--inner').classList.toggle('is-flipped');
      }
      disableButtons();
      showData(data);
    });
  });
};
const callbackCorrectAnswer = function (jsonObject) {
  console.log(jsonObject);
};
const callbackFalseAnswer = function (jsonObject) {
  console.log(jsonObject);
};

const addNumberToAnswer = function (id) {
  switch (id) {
    case 'a':
      console.log('a');
      globalStukData['answers-a'] = parseInt(globalStukData['answers-a']) + 1;
      console.log(globalStukData);
      putData('https://api-eindopdracht-interaction-design.azurewebsites.net/api/data', globalStukData);
      break;
    case 'b':
      console.log('b');
      globalStukData['answers-b'] = parseInt(globalStukData['answers-b']) + 1;
      putData('https://api-eindopdracht-interaction-design.azurewebsites.net/api/data', globalStukData);
      break;
    case 'c':
      console.log('c');
      globalStukData['answers-c'] = parseInt(globalStukData['answers-c']) + 1;
      putData('https://api-eindopdracht-interaction-design.azurewebsites.net/api/data', globalStukData);
      break;
    case 'd':
      console.log('d');
      globalStukData['answers-d'] = parseInt(globalStukData['answers-d']) + 1;
      putData('https://api-eindopdracht-interaction-design.azurewebsites.net/api/data', globalStukData);
      break;
    default:
      console.log('error');
  }
};
const listenToAnswers = function () {
  document.querySelectorAll('.js-answer').forEach((answer) => {
    answer.addEventListener('click', function (e) {
      let id = this.getAttribute('id');
      addNumberToAnswer(id);
      if (id === globalCorrectAnswer) {
        console.log('correct');
        document.querySelector('.c-answer-feedbacktext').classList.remove('c-answer-feedbacktext-false');
        document.querySelector('.c-answer-feedbacktext').classList.add('c-answer-feedbacktext-correct');
        document.querySelector('.c-answer-feedbacktext').innerHTML = 'Correct!';
      } else {
        console.log('false');
        document.querySelector('.c-answer-feedbacktext').classList.remove('c-answer-feedbacktext-true');
        document.querySelector('.c-answer-feedbacktext').classList.add('c-answer-feedbacktext-false');
        document.querySelector('.c-answer-feedbacktext').innerHTML = 'False!';
      }

      document.querySelector('.c-card--front').style.display = 'none';
      document.querySelector('.c-card--answers').style.display = 'block';
    });
  });
};

const disableButtons = function () {
  document.querySelectorAll('.js-disable').forEach((button) => {
    button.disabled = true;
    button.tabIndex = -1;
  });
  if (document.querySelector('.c-flip--inner').classList.contains('is-flipped')) {
    document.querySelector('.js-button--question').disabled = false;
    document.querySelector('.js-button--question').tabIndex = 0;

  }
  if (!document.querySelector('.c-flip--inner').classList.contains('is-flipped')) {
    document.querySelectorAll('.js-answer').forEach((answer) => {
      answer.disabled = false;
      answer.tabIndex = 0;
    });
    document.querySelector('.js-button--answer').disabled = false;
    document.querySelector('.js-button--answer').tabIndex = 0;
  }

};

const showData = function (data) {
  let random = Math.floor(Math.random() * data.length);
  console.log(random);
  let stukdata = data[random];
  globalStukData = stukdata;
  globalCorrectAnswer = `${stukdata['correct-option']}`;
  let scrollBars = document.querySelectorAll('.js-range');
  for (const item of scrollBars) {
    item.value = stukdata['difficulty'];
  }
  let questions = document.querySelectorAll('.js-question');
  for (const item of questions) {
    item.innerHTML = `${stukdata['question']}`;
  }
  let answerOptionA = document.querySelectorAll('.js-answer-a');
  for (const item of answerOptionA) {
    item.innerHTML = `A: ${stukdata['option-a']}`;
  }
  let answerOptionB = document.querySelectorAll('.js-answer-b');
  for (const item of answerOptionB) {
    item.innerHTML = `B: ${stukdata['option-b']}`;
  }
  let answerOptionC = document.querySelectorAll('.js-answer-c');
  for (const item of answerOptionC) {
    item.innerHTML = `C: ${stukdata['option-c']}`;
  }
  let answerOptionD = document.querySelectorAll('.js-answer-d');
  for (const item of answerOptionD) {
    item.innerHTML = `D: ${stukdata['option-d']}`;
  }
  let totaalPercentage = parseInt(stukdata['answers-a']) + parseInt(stukdata['answers-b']) + parseInt(stukdata['answers-c']) + parseInt(stukdata['answers-d']);
  percentageA = Math.round((parseInt(stukdata['answers-a']) / totaalPercentage) * 100);
  drawCircleA();
  percentageB = Math.round((parseInt(stukdata['answers-b']) / totaalPercentage) * 100);
  drawCircleB();
  percentageC = Math.round((parseInt(stukdata['answers-c']) / totaalPercentage) * 100);
  drawCircleC();
  percentageD = Math.round((parseInt(stukdata['answers-d']) / totaalPercentage) * 100);
  drawCircleD();

  document.querySelector('.js-answer-def').innerHTML = stukdata['answer'];
  if (stukdata['correct-option'].includes('a')) {
    console.log(stukdata['correct-option']);
    document.querySelector('.js-answer-box-a').classList.remove('c-answer-a-solution');
    document.querySelector('.js-answer-box-a').classList.add('c-answer-a');
    document.querySelector('.c-false-icon-a').style.display = 'none';
    document.querySelector('.c-correct-icon-a').style.display = 'block';

    document.querySelector('.js-answer-box-b').classList.remove('c-answer-b');
    document.querySelector('.js-answer-box-b').classList.add('c-answer-b-solution');
    document.querySelector('.c-false-icon-b').style.display = 'block';
    document.querySelector('.c-correct-icon-b').style.display = 'none';

    document.querySelector('.js-answer-box-c').classList.remove('c-answer-c');
    document.querySelector('.js-answer-box-c').classList.add('c-answer-c-solution');
    document.querySelector('.c-false-icon-c').style.display = 'block';
    document.querySelector('.c-correct-icon-c').style.display = 'none';

    document.querySelector('.js-answer-box-d').classList.remove('c-answer-d');
    document.querySelector('.js-answer-box-d').classList.add('c-answer-d-solution');
    document.querySelector('.c-false-icon-d').style.display = 'block';
    document.querySelector('.c-correct-icon-d').style.display = 'none';
  } else if (stukdata['correct-option'].includes('b')) {
    console.log(stukdata['correct-option']);
    document.querySelector('.js-answer-box-a').classList.remove('c-answer-a');
    document.querySelector('.js-answer-box-a').classList.add('c-answer-a-solution');
    document.querySelector('.c-false-icon-a').style.display = 'block';
    document.querySelector('.c-correct-icon-a').style.display = 'none';

    document.querySelector('.js-answer-box-b').classList.remove('c-answer-b-solution');
    document.querySelector('.js-answer-box-b').classList.add('c-answer-b');
    document.querySelector('.c-false-icon-b').style.display = 'none';
    document.querySelector('.c-correct-icon-b').style.display = 'block';

    document.querySelector('.js-answer-box-c').classList.remove('c-answer-c');
    document.querySelector('.js-answer-box-c').classList.add('c-answer-c-solution');
    document.querySelector('.c-false-icon-c').style.display = 'block';
    document.querySelector('.c-correct-icon-c').style.display = 'none';

    document.querySelector('.js-answer-box-d').classList.remove('c-answer-d');
    document.querySelector('.js-answer-box-d').classList.add('c-answer-d-solution');
    document.querySelector('.c-false-icon-d').style.display = 'block';
    document.querySelector('.c-correct-icon-d').style.display = 'none';
  } else if (stukdata['correct-option'].includes('c')) {
    console.log(stukdata['correct-option']);
    document.querySelector('.js-answer-box-a').classList.remove('c-answer-a');
    document.querySelector('.js-answer-box-a').classList.add('c-answer-a-solution');
    document.querySelector('.c-false-icon-a').style.display = 'block';
    document.querySelector('.c-correct-icon-a').style.display = 'none';

    document.querySelector('.js-answer-box-b').classList.remove('c-answer-b');
    document.querySelector('.js-answer-box-b').classList.add('c-answer-b-solution');
    document.querySelector('.c-false-icon-b').style.display = 'block';
    document.querySelector('.c-correct-icon-b').style.display = 'none';

    document.querySelector('.js-answer-box-c').classList.remove('c-answer-c-solution');
    document.querySelector('.js-answer-box-c').classList.add('c-answer-c');
    document.querySelector('.c-false-icon-c').style.display = 'none';
    document.querySelector('.c-correct-icon-c').style.display = 'block';

    document.querySelector('.js-answer-box-d').classList.remove('c-answer-d');
    document.querySelector('.js-answer-box-d').classList.add('c-answer-d-solution');
    document.querySelector('.c-false-icon-d').style.display = 'block';
    document.querySelector('.c-correct-icon-d').style.display = 'none';
  } else if (stukdata['correct-option'].includes('d')) {
    console.log(stukdata['correct-option']);
    document.querySelector('.js-answer-box-a').classList.remove('c-answer-a');
    document.querySelector('.js-answer-box-a').classList.add('c-answer-a-solution');
    document.querySelector('.c-false-icon-a').style.display = 'block';
    document.querySelector('.c-correct-icon-a').style.display = 'none';

    document.querySelector('.js-answer-box-b').classList.remove('c-answer-b');
    document.querySelector('.js-answer-box-b').classList.add('c-answer-b-solution');
    document.querySelector('.c-false-icon-b').style.display = 'block';
    document.querySelector('.c-correct-icon-b').style.display = 'none';

    document.querySelector('.js-answer-box-c').classList.remove('c-answer-c');
    document.querySelector('.js-answer-box-c').classList.add('c-answer-c-solution');
    document.querySelector('.c-false-icon-c').style.display = 'block';
    document.querySelector('.c-correct-icon-c').style.display = 'none';

    document.querySelector('.js-answer-box-d').classList.remove('c-answer-d-solution');
    document.querySelector('.js-answer-box-d').classList.add('c-answer-d');
    document.querySelector('.c-false-icon-d').style.display = 'none';
    document.querySelector('.c-correct-icon-d').style.display = 'block';
  }
};

const getQuestions = async () => {
  data = await getData('https://api-eindopdracht-interaction-design.azurewebsites.net/api/data');
  console.log(data);
  showData(data);
};

const drawCircleA = function () {
  var chartProgress = document.getElementById('chartProgressA');

  if (chartProgress) {
    console.log(chartProgress);

    myChartCircleA = new Chart('chartProgressA', {
      type: 'doughnut',
      data: {
        datasets: [
          {
            label: 'Option A',
            percent: percentageA,
            backgroundColor: ['#FF0000'],
          },
        ],
      },
      plugins: [
        {
          beforeInit: (chart) => {
            const dataset = chart.data.datasets[0];
            chart.data.labels = [dataset.label];
            dataset.data = [dataset.percent, 100 - dataset.percent];
          },
        },
        {
          beforeDraw: (chart) => {
            var width = chart.chart.width,
              height = chart.chart.height,
              ctx = chart.chart.ctx;
            ctx.restore();
            var fontSize = (height / 100).toFixed(2);
            ctx.font = fontSize + 'em sans-serif';
            ctx.fillStyle = '#9b9b9b';
            ctx.textBaseline = 'middle';
            var text = chart.data.datasets[0].percent + '%',
              textX = Math.round((width - ctx.measureText(text).width) / 2),
              textY = height / 2;
            ctx.fillText(text, textX, textY);
            ctx.save();
          },
        },
      ],
      options: {
        maintainAspectRatio: true,
        responsive: true,
        cutoutPercentage: 70,
        rotation: Math.PI / 2,
        legend: {
          display: false,
        },
        tooltips: {
          filter: (tooltipItem) => tooltipItem.index == 0,
        },
      },
    });
  }
};
const drawCircleB = function () {
  var chartProgress = document.getElementById('chartProgressB');

  if (chartProgress) {
    console.log(chartProgress);

    myChartCircleB = new Chart('chartProgressB', {
      type: 'doughnut',
      data: {
        datasets: [
          {
            label: 'Option B',
            percent: percentageB,
            backgroundColor: ['#0000FF'],
          },
        ],
      },
      plugins: [
        {
          beforeInit: (chart) => {
            const dataset = chart.data.datasets[0];
            chart.data.labels = [dataset.label];
            dataset.data = [dataset.percent, 100 - dataset.percent];
          },
        },
        {
          beforeDraw: (chart) => {
            var width = chart.chart.width,
              height = chart.chart.height,
              ctx = chart.chart.ctx;
            ctx.restore();
            var fontSize = (height / 100).toFixed(2);
            ctx.font = fontSize + 'em sans-serif';
            ctx.fillStyle = '#9b9b9b';
            ctx.textBaseline = 'middle';
            var text = chart.data.datasets[0].percent + '%',
              textX = Math.round((width - ctx.measureText(text).width) / 2),
              textY = height / 2;
            ctx.fillText(text, textX, textY);
            ctx.save();
          },
        },
      ],
      options: {
        maintainAspectRatio: true,
        responsive: true,
        cutoutPercentage: 70,
        rotation: Math.PI / 2,
        legend: {
          display: false,
        },
        tooltips: {
          filter: (tooltipItem) => tooltipItem.index == 0,
        },
      },
    });
  }
};

const drawCircleC = function () {
  var chartProgress = document.getElementById('chartProgressC');

  if (chartProgress) {
    console.log(chartProgress);

    myChartCircleC = new Chart('chartProgressC', {
      type: 'doughnut',
      data: {
        datasets: [
          {
            label: 'Option C',
            percent: percentageC,
            backgroundColor: ['#B8530F'],
          },
        ],
      },
      plugins: [
        {
          beforeInit: (chart) => {
            const dataset = chart.data.datasets[0];
            chart.data.labels = [dataset.label];
            dataset.data = [dataset.percent, 100 - dataset.percent];
          },
        },
        {
          beforeDraw: (chart) => {
            var width = chart.chart.width,
              height = chart.chart.height,
              ctx = chart.chart.ctx;
            ctx.restore();
            var fontSize = (height / 100).toFixed(2);
            ctx.font = fontSize + 'em sans-serif';
            ctx.fillStyle = '#9b9b9b';
            ctx.textBaseline = 'middle';
            var text = chart.data.datasets[0].percent + '%',
              textX = Math.round((width - ctx.measureText(text).width) / 2),
              textY = height / 2;
            ctx.fillText(text, textX, textY);
            ctx.save();
          },
        },
      ],
      options: {
        maintainAspectRatio: true,
        responsive: true,
        cutoutPercentage: 70,
        rotation: Math.PI / 2,
        legend: {
          display: false,
        },
        tooltips: {
          filter: (tooltipItem) => tooltipItem.index == 0,
        },
      },
    });
  }
};

const drawCircleD = function () {
  var chartProgress = document.getElementById('chartProgressD');

  if (chartProgress) {
    console.log(chartProgress);

    myChartCircleD = new Chart('chartProgressD', {
      type: 'doughnut',
      data: {
        datasets: [
          {
            label: 'Option D',
            percent: percentageD,
            backgroundColor: ['#008000'],
          },
        ],
      },
      plugins: [
        {
          beforeInit: (chart) => {
            const dataset = chart.data.datasets[0];
            chart.data.labels = [dataset.label];
            dataset.data = [dataset.percent, 100 - dataset.percent];
          },
        },
        {
          beforeDraw: (chart) => {
            var width = chart.chart.width,
              height = chart.chart.height,
              ctx = chart.chart.ctx;
            ctx.restore();
            var fontSize = (height / 100).toFixed(2);
            ctx.font = fontSize + 'em sans-serif';
            ctx.fillStyle = '#9b9b9b';
            ctx.textBaseline = 'middle';
            var text = chart.data.datasets[0].percent + '%',
              textX = Math.round((width - ctx.measureText(text).width) / 2),
              textY = height / 2;
            ctx.fillText(text, textX, textY);
            ctx.save();
          },
        },
      ],
      options: {
        maintainAspectRatio: true,
        responsive: true,
        cutoutPercentage: 70,
        rotation: Math.PI / 2,
        legend: {
          display: false,
        },
        tooltips: {
          filter: (tooltipItem) => tooltipItem.index == 0,
        },
      },
    });
  }
};

const getData = async (endpoint) => {
  return fetch(endpoint)
    .then((r) => r.json())
    .then((d) => d)
    .catch((e) => console.error(e));
};
const putData = async (endpoint, data) => {
  const response = await fetch(endpoint, {
    method: 'PUT',
    headers: {
      'Content-type': 'application/json',
    },
    body: JSON.stringify(data),
  });
  console.log(response);
};

const listenToBeforePrint = function () {
  if (myChartCircleA) {
    myChartCircleA.addEventListener('beforeprint', drawCircleA);
  }
  if (myChartCircleB) {
    myChartCircleB.addEventListener('beforeprint', drawCircleB);
  }
  if (myChartCircleC) {
    myChartCircleC.addEventListener('beforeprint', drawCircleC);
  }
  if (myChartCircleD) {
    myChartCircleD.addEventListener('beforeprint', drawCircleD);
  }
};

const listenToAfterPrint = function () {
  if (myChartCircleA) {
    myChartCircleA.addEventListener('afterprint', drawCircleA);
  }
  if (myChartCircleB) {
    myChartCircleB.addEventListener('afterprint', drawCircleB);
  }
  if (myChartCircleC) {
    myChartCircleC.addEventListener('afterprint', drawCircleC);
  }
  if (myChartCircleD) {
    myChartCircleD.addEventListener('afterprint', drawCircleD);
  }
};

const init = function () {
  console.log('App initialized');

  getQuestions();
  listenToButtonAnswerQuestion();
  listenToAnswers();
  listenToReloadButton();
  listenToBeforePrint();
  listenToAfterPrint();
  disableButtons();
};
window.onbeforeprint = (event) => {
  console.log('Before print');
};

document.addEventListener('DOMContentLoaded', init);

    </script>
</body>

</html>